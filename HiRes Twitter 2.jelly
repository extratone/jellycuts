import Shortcuts
#Color: Red, #Icon: star

/*
Download media from public/private/circle/community tweets at the highest quality, save to Photos or Files or share.
2023-07-14 	v4.1.8
https://routinehub.co/user/gluebyte
https://mastodon.social/@gluebyte
*/
var 7C76F1B3-F4A9-4B27-B155-69A1494DB435 = """{"version": "2023-07-14",
"id": "BE3F1DF7",
"prefversion": 5,
"filename": "Shortcuts/HiRes Tweet.json",
"defaultpref": {
	"prefversion": 5,
	"selection": [ 4, 3, 1, 1, 1, 2, 2, 1, 2, 3, 1 ]
},
"prefstring": [
	{
		"title": "Save gif as",
		"option": [ "mp4 [1/4]", "gif [2/4]", "Both mp4 and gif [3/4]", "Ask Always [4/4]" ]
	},
	{
		"title": "â¤· gif Quality",
		"option": [ "High (Requires a-Shell mini) [1/3]", "Low [2/3]", "Ask Always [3/3]" ]
	},
	{
		"title": "Quick Look",
		"option": [ "None [1/3]", "All Media [2/3]", "Only Videos and gifs [3/3]" ]
	},
	{ "title": "â¤· Ask to Continue after Quick Look" },
	{ "title": "Show List for Multiple Media" },
	{ "title": "Share" },
	{ "title": "Save to Files" },
	{ "title": "Save to Photos" },
	{ "title": "â¤· Open Photos after Save" },
	{
		"title": "Set Media Date to",
		"option": [ "Date Tweeted (Requires a-Shell mini) [1/3]", "Current Date [2/3]", "Ask Always [3/3]" ]
	},
	{ "title": "Show Notification" }
],
"option": [ "â˜‘ï¸", "â¬œï¸" ],
"worker": "https://hirestweet.gluebyte.workers.dev/",
"shortcutpage": "https://routinehub.co/shortcut/7912/",
"downloadurl": "https://routinehub.co/api/v1/shortcuts/7912/versions/latest",
"false": false,
"true": true,
"onmy": "On My ",
"settings": "âš™ï¸  User Settings",
"account": "â­ï¸  Manage Twitter Accounts in Scriptable",
"quit": "ðŸ”š  Quit",
"download": "download",
"getlink": "ðŸ“‹ Download Media from Copied Link",
"goback": "â®  Go Back",
"gotoweb": "ðŸŒ  Go to RoutineHub",
"dateoptions": [ "Always Date Tweeted", "Always Current Date", "Date Tweeted", "Current Date" ],
"gifoptions": [ "Always mp4 and gif", "Always gif", "Always mp4", "mp4 and gif", "gif", "mp4" ],
"gifqualityoptions": [ "Always Low", "Always High", "Low", "High" ],
"getscriptable": "ðŸ“²  Get Scriptable from App Store",
"havescriptable": "âœ…  I have Scriptable",
"getashell": "ðŸ“²  Get a-Shell mini from App Store",
"haveashell": "âœ…  I have a-Shell mini",
"quicklookboth": "ðŸ”Ž  Quick Look Both",
"getbetter": "ðŸ”¸  Get Better Quality (",
"getbest": "ðŸ”¶  Get Best Quality (",
"getboth": "ðŸ’•  Get Both",
"continue": "ðŸ’«  Continue",
"getsub": "ðŸŽžï¸  Download Caption",
"skip": "â¬ï¸  Skip",
"contact": "ðŸ§  Contact gluebyte on RoutineHub",
"downloadupdate": "ðŸ‘¾  Download Update",
"notnow": "â®  Not Now",
"folder": "â€¢ Media Folder: ",
"album": "â€¢ Media Album: ",
"recents": "Recents",
"msg": {
	"error1": "Cannot download media. Current account in Scriptable: @",
	"error2": "Cannot download media. Please log in to Twitter using Scriptable in the next menu.",
	"error3": "Cannot download media. Please try again later or contact developer.",
	"error4": "Account error. Please close the Scriptable window after Twitter is loaded.",
	"error5": "Scriptable error. Please delete and reinstall Scriptable and this shortcut.",
	"oldpref": "\nThis shortcut is older than the settings file. Please download the latest version.\n",
	"newpref": "User settings have been updated. Please review new settings.",
	"notweeturl": "Please share a tweet.",
	"nosave": "\nMedia is not saved or shared. â€™User Settingsâ€˜ menu will open.\n",
	"nomedia": "\nNo media attached to tweet.\n",
	"dateprompt": "\nChoose date of media. The free â€˜a-Shell miniâ€™ app is required for â€˜Date Tweetedâ€™:\n",
	"optionsaved": "\nâœ¨ Option has been saved. To change settings, run â€˜HiRes Twitterâ€™ from the Shortcuts app.\n",
	"gifprompt": "\nSave gif as:\n",
	"gifqualityprompt": "\nPlease select gif quality. â€˜Lowâ€™ is faster, â€˜Highâ€™ requires the free â€˜a-Shell miniâ€™ app:\n",
	"scriptableprompt": "\nThis shortcut needs the free â€˜Scriptableâ€™ app.\n",
	"ashellprompt": "\nIs â€˜a-Shell miniâ€™ installed?\n",
	"gifprompt2": "\nNote: â€˜Betterâ€™ may look better than â€˜Bestâ€™ if color changes and movements are small across frames.\n",
	"album": "\nPlease select photo album from the following list. You can change it later in â€˜User Settingsâ€™.\n",
	"subprompt": "\nVideo caption is available.\nDownloaded SRT file can be saved to Files or sent through AirDrop.\n",
	"accountsprompt": "\nAccounts logged in in Scriptable:",
	"noaccountprompt": "\nPrivate/circle/community media can be downloaded after logging in.\n",
	"settingprompt": "Tap any item to change option. To reset folder or album, turn the option off and on.",
	"locationprompt": "\nWhere do you want to save media?\n",
	"folderprompt1": "\nEnter folder name for media:\n",
	"folderprompt2": "\nEnter folder name for media. It will be created inside iCloud Drive/Shortcuts folder:\n",
	"accountprompt": "\n\nScriptable will open Twitter web.\nPlease close browser when finished.\n\n",
	"noclipboard": "\nNo Twitter link in clipboard.\n",
	"newversion": "New Version Available",
}
}"""
text("${7C76F1B3-F4A9-4B27-B155-69A1494DB435}")
getDictionaryFrom(input: Text) >> getDictionaryFrom
var mainDict = Dictionary
number(value: 0) >> number
if(DeviceDetails != nil) {
	number(value: 1) >> number 1
} >> IFResult
var OS = If Result
/*


â—¥â—¤		CHECK INPUT
*/
if(ShortcutInput != nil) { >> IFResult 1
	getItemFromList(list: ShortcutInput, type: Last Item) >> getItemFromList
	if(Item from List .contains "t.co/") {
		expandURL(url: "${Item from List}") >> expandURL
	} >> IFResult 2
	replaceText(input: "${If Result}", find: "\?.*", isRegex: true) >> twurl
	if(twurl .contains "twitter.com/") {
		replaceText(input: "ã…${twurl}", find: "^.*/(\d{17,}).*$", replace: "$1", isRegex: true) >> ID
		if(ID .beginsWith "ã…") {
			alert(alert: "${mainDict.key(msg.notweeturl)}
â€˜${Variable.key(msg.notweeturl)}â€™", cancel: false)
		} else {
var input = twurl
var command = Variable
		} >> IFResult 3
	} else {
		alert(alert: "${mainDict.key(msg.notweeturl)}
â€˜${Variable.key(msg.notweeturl)}â€™", cancel: false)
	}
} >> IFResult 4
/*


â—¥â—¤		CHECK PREF
*/
if(OS == 0) { >> IFResult 5
	replaceText(input: "${mainDict.key(filename)}", find: "Shortcuts/") >> replaceText
	setValue(key: "filename", value: "${Updated Text}", dictionary: mainDict) >> setValue
var mainDict = Dictionary
} >> IFResult 6
getFile(picker: false, path: "${mainDict.key(filename)}", error: false) >> getFile
if(File == nil) { >> IFResult 7
	getDictionaryFrom(input: mainDict) >> getDictionaryFrom 1
var pref = Dictionary
	saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile
} else { >>  1
	getDictionaryFrom(input: File) >> getDictionaryFrom 2
var pref = Dictionary
	keysFrom(dictionary: pref) >> prefversion
	if(prefversion != mainDict) {
		if(prefversion > mainDict) {
			menu(, [) {
			case("mainDict (gotoweb)"):
				openURL(url: mainDict)
			} >> MenuResult
			exit()
		} >> IFResult 8
		combineText(text: pref, combine: Custom) >> combineText
		if(prefversion == 1) {
			replaceText(input: "${Combined Text}", find: "...$", replace: "2$0", isRegex: true) >> replaceText 1
		} >> IFResult 9
		if(prefversion false 3) {
			replaceText(input: "${If Result}", find: "^.", replace: "$03", isRegex: true) >> replaceText 2
		} >> IFResult 10
		if(prefversion false 4) {
			replaceText(input: "${If Result}", find: ".$", replace: "2$0", isRegex: true)
		} >> IFResult 11
		if(prefversion false 5) {
			replaceText(input: "${If Result}", find: "2(.)$", replace: "3$1", isRegex: true)
		} >> IFResult 12
		splitText(text: If Result, separator: Every Character) >> splitText
		setValue(key: "selection", value: "${Split Text.as(Number)}", dictionary: pref) >> setValue 1
		setValue(key: "prefversion", value: "${mainDict.key(prefversion)}", dictionary: Dictionary) >> setValue 2
var pref = Dictionary
		saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 1
	} else {
		if(input != nil) {
			getItemFromList(list: pref, type: Items in Range, startIndex: "6", endIndex: "8") >> getItemFromList 1
			if(Item from List .contains "1") {
				if(Item from List .contains "Ù¡") {
					alert(alert: "${mainDict.key(msg.nosave)}", cancel: false)
var command = Variable
				}
			}
		} >> IFResult 13
	} >> IFResult 14
} >> IFResult 15
/*


â—¥â—¤		CHECK SCRIPTABLE
*/
if(pref == nil) { >> IFResult 16
	menu(, [) {
	case("mainDict (getscriptable)"):
		openURL(url: "https://apps.apple.com/app/id1405459188") >> openURL
		exit()
	case("mainDict (havescriptable)"):
		openApp(id: "dk.simonbs.Scriptable")
		setValue(key: "has Scriptable", value: "1", dictionary: pref) >> setValue 3
var pref = Dictionary
		saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 2
	}
} >> IFResult 17
repeat(20) {
/*


â—¥â—¤		LOOP
*/
	if(command != ""${mainDict.key(quit)}"") {
		if(command == ""${mainDict.key(download)}"") { >> IFResult 18
/*


â—¥â—¤		DOWNLOAD
*/
var command = Variable
//Unable to get shortcuts action dk.simonbs.Scriptable.RunScriptInlineIntent
			getDictionaryFrom(input: Output) >> getDictionaryFrom 3
var tweetDict = Dictionary
			if(tweetDict != nil) {
				openApp(id: "dk.simonbs.Scriptable")
				openApp(id: "com.atebits.Tweetie2")
				runShortcut(name: "HiRes Twitter", input: input)
				exit()
			}
			if(tweetDict != nil) {
				wait(seconds: tweetDict)
				runShortcut(name: "HiRes Twitter", input: input)
				exit()
			}
var version = Variable
			if(tweetDict == nil) {
				if(tweetDict != nil) { >> IFResult 19
					getTextFrom(input: tweetDict) >> error
					if(error .contains ""statusCode":403") {
						if(error .contains ""code":336") {
							alert(alert: "
ðŸ›‘  ${mainDict.key(msg.error5)}
", tancel: false)
						} else {
//Unable to get shortcuts action dk.simonbs.Scriptable.RunScriptInlineIntent
							alert(alert: "
ðŸ›‘  ${mainDict.key(msg.error4)}
", tancel: false)
						}
					} else {
						if(error .contains ""code":179") {
//Unable to get shortcuts action is.workflow.actions.setvariable
							if(tweetDict != nil) {
								text(text: "${mainDict.key(msg.error1)}${Variable.key(msg.error1)}")
							} else {
								keysFrom(dictionary: mainDict)
							}
						} else {
							keysFrom(dictionary: mainDict)
						} >> IFResult 20
						alert(alert: "${input}
âž¡ï¸  ${Variable}

ðŸ›‘  ï¿¼", tincel: false)
					}
				} else {
					alert(alert: "${input}
${Variable}", cancel: false)
				} >> IFResult 21
			} else {
				keysFrom(dictionary: tweetDict) >> hasgif
				number(value: 0) >> number 2
				if(hasgif ==) { >> IFResult 22
					math(input: pref, operation: -, operand: "1") >> math
					if(Calculation Result == 3) {
						repeatEach(mainDict) {
							setName(input: Repeat Index 2, name: "${Repeat Item 2}")
						} >> RepeatResult
						choose(list: Repeat Results, prompt: "${mainDict.key(msg.gifprompt)}") >> choose
						math(input: "6", operation: -, operand: Chosen Item) >> math 1
						if(Calculation Result > 2) {
							math(input: Calculation Result, operation: -, operand: "2") >> math 2
var newSelection = Calculation Result
							getItemFromList(list: pref, type: Items in Range, startIndex: "2") >> getItemFromList 2
//Unable to get shortcuts action is.workflow.actions.appendvariable
							setValue(key: "selection", value: "${newSelection}", dictionary: pref) >> setValue 4
var pref = Dictionary
							saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 3
							alert(alert: "${mainDict.key(msg.optionsaved)}", cancel: false)
							math(input: Calculation Result, operation: -, operand: "1")
						}
					} >> IFResult 23
				} >> toGIF
				if(toGIF != 0) { >> IFResult 24
					math(input: "2", operation: -, operand: pref) >> math 3
					if(Calculation Result false 0) {
						repeatEach(mainDict) {
							setName(input: Repeat Index 2, name: "${Repeat Item 2}")
						} >> RepeatResult 1
						choose(list: Repeat Results, prompt: "${mainDict.key(msg.gifqualityprompt)}") >> choose 1
						math(input: Chosen Item, operation: -, operand: "3") >> math 4
						if(Calculation Result false 0) {
							math(input: "3", operation: -, operand: Chosen Item) >> math 5
							combineText(text: pref, combine: Custom) >> combineText 1
							replaceText(input: "${Combined Text}", find: "^(.).", replace: "$1${Calculation Result}", isRegex: true) >> replaceText 3
							splitText(text: Updated Text, separator: Every Character) >> splitText 1
							setValue(key: "selection", value: "${Split Text.as(Number)}", dictionary: pref) >> setValue 5
var pref = Dictionary
							saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 4
							alert(alert: "${mainDict.key(msg.optionsaved)}", cancel: false)
							math(input: Chosen Item, operation: -, operand: "1") >> math 6
						}
					}
				} >> GIF Quality
				keysFrom(dictionary: pref) >> Media Date
				if(Media Date == 3) { >> IFResult 25
					repeatEach(mainDict) {
						setName(input: Repeat Index 2, name: "${Repeat Item 2}")
					} >> RepeatResult 2
					choose(list: Repeat Results, prompt: "${mainDict.key(msg.dateprompt)}") >> choose 2
					math(input: Chosen Item, operation: -, operand: "2") >> math 7
					if(Calculation Result false 1) {
						combineText(text: pref, combine: Custom) >> combineText 2
						replaceText(input: "${Combined Text}", find: ".(.)$", replace: "${Chosen Item}$1", isRegex: true) >> replaceText 4
						splitText(text: Updated Text, separator: Every Character) >> splitText 2
						setValue(key: "selection", value: "${Split Text.as(Number)}", dictionary: pref) >> setValue 6
var pref = Dictionary
						saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 5
						alert(alert: "${mainDict.key(msg.optionsaved)}", cancel: false)
//Unable to get shortcuts action is.workflow.actions.getvariable
					}
				} >> MediaDate
				adjustDate(duration: , date: "1970-01-01 00:00:00Z") >> adjustDate
				if(MediaDate == 1) { >> IFResult 26
					formatDate(date: "${Adjusted Date}", dStyle: Custom, custom: "'-t 'yyyyMMddHHmm.ss") >> -t MediaDate
				} >> IFResult 27
				if(pref == nil) { >> IFResult 28
					matchText(text: "${toGIF}${ActionOutput}${GIF Quality}", regex: "^[12]1|1$|^[Ù¡Ù¢]Ù¡|Ù¡$") >> matchText
					if(Matches != nil) {
						menu(, [) {
						case("mainDict (getashell)"):
							openURL(url: "https://apps.apple.com/app/id1543537943")
							exit()
						case("mainDict (haveashell)"):
							setValue(key: "has a-Shell mini", value: "1", dictionary: pref) >> setValue 7
var pref = Dictionary
							saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 6
						}
					}
				} >> IFResult 29
				downloadURL(url: "${tweetDict.key(url)}") >> downloadURL
				if(Contents of URL .contains " / Error") { >> IFResult 30
					quicklook(input: Contents of URL)
				} else {
var media = Contents of URL
					keysFrom(dictionary: pref) >> Quick Look
					if(Quick Look != 1) { >> IFResult 31
						quicklook(input: media)
						keysFrom(dictionary: pref) >> â¤·Ask after Quick Look
						if(â¤·Ask after Quick Look == 1) {
							menu(, [) {
							case("mainDict (continue)"):
							case("mainDict (quit)"):
//Unable to get shortcuts action is.workflow.actions.setvariable
							}
						}
					} >> IFResult 32
					repeatEach(media) {
						getItemFromList(list: tweetDict, type: Item At Index, index: Repeat Index 2) >> getItemFromList 3
						setName(input: Repeat Item 2, name: "${Item from List}")
					} >> RepeatResult 3
var media = Repeat Results
					count(input: media) >> count
					if(Count > 1) {
						keysFrom(dictionary: pref) >> Select if Multiple
						if(Select if Multiple == 1) {
							choose(list: media, multiple: true, all: true) >> choose 3
var media = Chosen Item
						} >> IFResult 33
					} >> IFResult 34
					repeatEach(media) {
var Info = Variable
						keysFrom(dictionary: Info) >> type
						if(type == "photo") {
//Unable to get shortcuts action is.workflow.actions.appendvariable
							text(text: "${Repeat Item 2.as(Image).get(Width)} ${Variable.as(Image).get(Width)}x${Repeat Item 2.as(Image).get(Height)} (${Variable.as(Image).get(Height)})") >> text
//Unable to get shortcuts action is.workflow.actions.appendvariable
						} >> IFResult 35
						number(value: 0) >> number 3
						if(type == "video") {
							number(value: 1)
						} >> IFResult 36
						if(type == "animated_gif") {
							if(toGIF != 1) {
								number(value: 1)
							}
						} >> IFResult 37
						if(If Result == 1) {
//Unable to get shortcuts action is.workflow.actions.getvariable
							if(type == "video") {
								if(Repeat Item 2 false) {
var 6FB04D7A-1646-4C48-9E4C-502537E894CE = """touch begin
rm -f done merge.mp4
hideKeyboard
echo
ffmpeg -v error -i "ï¿¼" -codec copy -y merge.mp4
touch done
echo"""
text("${6FB04D7A-1646-4C48-9E4C-502537E894CE}")
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									wait(seconds: 2)
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									if(output .beginsWith "begin") {
									} else {
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									}
//Unable to get shortcuts action is.workflow.actions.setvariable
									repeat(30) {
										if(loop .beginsWith "done") {
										} else {
											wait()
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
var loop = output
										}
									}
									openApp(id: "com.atebits.Tweetie2")
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.GetFileIntent
								}
							} >> IFResult 38
							if(MediaDate == 2) {
								encodeMedia(media: If Result) >> encodeMedia
								getFileOfType(input: Encoded Media, type: "public.mpeg-4") >> getFileOfType
							} >> IFResult 39
//Unable to get shortcuts action is.workflow.actions.appendvariable
							text(text: "${Info.as(Dictionary).key(width)} ${Variable.as(Dictionary).key(width)}x${Info.as(Dictionary).key(height)} (${Variable.as(Dictionary).key(height)})") >> text 1
//Unable to get shortcuts action is.workflow.actions.appendvariable
						}
						if(type == "animated_gif") {
							if(toGIF != 0) { >> IFResult 40
								if(GIF Quality == 0) {
									math(input: "1", operation: /, operand: Repeat Item 2) >> math 8
									keysFrom(dictionary: Info) >> w
									keysFrom(dictionary: Info) >> h
									if(w > h) {
										makeGIF(content: Repeat Item 2, frameTime: Calculation Result, autoSize: false, height: w) >> makeGIF
									} else {
										makeGIF(content: Repeat Item 2, frameTime: Calculation Result, autoSize: false, width: h) >> makeGIF 1
									} >> IFResult 41
//Unable to get shortcuts action is.workflow.actions.appendvariable
									text(text: "${Info.as(Dictionary).key(width)}${Variable.as(Dictionary).key(width)}x${Info.as(Dictionary).key(height)} (${Variable.as(Dictionary).key(height)})") >> text 2
//Unable to get shortcuts action is.workflow.actions.appendvariable
								} else {
									setName(input: Repeat Item 2, name: "a.mp4") >> setName
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.PutFileIntent
									imageDetail(detail: Frame Rate, image: Repeat Item 2) >> imageDetail
									setValue(key: "f", value: "${Frame Rate}") >> setValue 8
									matchText(text: "${Dictionary}", regex: "(?<=:)\d+(\.\d{1,6})?") >> Frame Rate
var 4EE45250-FC3C-456D-874E-DB33DEC688F4 = """touch begin
rm -f done Better.gif Best.gif
hideKeyboard
echo "	ðŸ•‘  PLEASE WAIT  ðŸ•“"
echo
ffmpeg -v error -stats -i a.mp4 -filter_complex "[0:v]tpad=stop_mode=clone:stop_duration=0"`bc -e "scale=3;.8/ï¿¼"`",fps=ï¿¼,split[a][b];[a]palettegen=reserve_transparent=0:stats_mode=diff[p];[b][p]paletteuse=dither=floyd_steinberg" -y Better.gif
echo
ffmpeg -v error -stats -i a.mp4 -filter_complex "[0:v]tpad=stop_mode=clone:stop_duration=0"`bc -e "scale=3;.8/ï¿¼"`",fps=ï¿¼,split[a][b];[a]palettegen=reserve_transparent=0:stats_mode=single[p];[b][p]paletteuse=dither=floyd_steinberg:new=1" -y Best.gif
touch ï¿¼ Better.gif Best.gif
touch done
echo"""
text("${4EE45250-FC3C-456D-874E-DB33DEC688F4}")
									replaceText(input: "${Text}", find: "
", replace: ";") >> replaceText 5
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									wait(seconds: 2)
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									if(output .beginsWith "begin") {
									} else {
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
									}
//Unable to get shortcuts action is.workflow.actions.setvariable
									repeat(10) {
										if(loop .beginsWith "done") {
										} else {
											repeat(10) {
												if(loop .beginsWith "done") {
												} else {
													wait()
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
var loop = output
													nothing()
												}
											}
										}
									}
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.GetFileIntent
									setName(input: Better, name: "Better.gif") >> Better
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.GetFileIntent
									setName(input: Best, name: "Best.gif") >> Best
									text(text: "${Better.as(Image).get(Width)} ${ActionOutput.as(Image).get(Width)}x${Better.as(Image).get(Height)} (${ActionOutput.as(Image).get(Height)})") >> text 3
									text(text: "${Best.as(Image).get(Width)} ${ActionOutput.as(Image).get(Width)}x${Best.as(Image).get(Height)} (${ActionOutput.as(Image).get(Height)})") >> text 4
									list(items: (
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        OutputName = Better;
                        OutputUUID = "A1995D02-5615-4F3A-B21D-F9A21C08FD12";
                        Type = ActionOutput;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        OutputName = Best;
                        OutputUUID = "662863E4-38B8-4552-A118-97808825AF6A";
                        Type = ActionOutput;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    }
)) >> list
var loop = Variable
									repeat(10) { >> RepeatResult 4
										if(loop ==) {
var loop = Variable
											menu(, [) {
											case("mainDict (quicklookboth)"):
var loop = Variable
												quicklook(input: List)
											case("mainDict (getbetter)Better (File Size))"):
//Unable to get shortcuts action is.workflow.actions.appendvariable
//Unable to get shortcuts action is.workflow.actions.appendvariable
											case("mainDict (getbest)Best (File Size))"):
//Unable to get shortcuts action is.workflow.actions.appendvariable
//Unable to get shortcuts action is.workflow.actions.appendvariable
											case("mainDict (getboth)"):
//Unable to get shortcuts action is.workflow.actions.appendvariable
//Unable to get shortcuts action is.workflow.actions.appendvariable
//Unable to get shortcuts action is.workflow.actions.appendvariable
//Unable to get shortcuts action is.workflow.actions.appendvariable
											} >> MenuResult 1
										}
										nothing()
									} >> RepeatResult 5
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
								} >> IFResult 42
							} >> IFResult 43
						} >> IFResult 44
						nothing()
					} >> RepeatResult 6
					if(GIF Quality > 0) {
						openApp(id: "com.atebits.Tweetie2")
					} >> IFResult 45
					count(input: _media) >> count 1
					repeatEach(_media) {
						nothing()
						if(Count > 1) {
							text(text: " ${Repeat Index 2}")
						} >> IFResult 46
						setName(input: Repeat Item 2, name: "${tweetDict.key(user)} ${Variable.key(user)}${If Result}")
					} >> RepeatResult 7
var media = Repeat Results
					if(MediaDate == 1) { >> IFResult 47
						repeatEach(media) {
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.PutFileIntent
							nothing() >> nothing
							if(Repeat Item 2 == "mp4") {
								replaceText(input: "${-t MediaDate}", find: "\D+", isRegex: true) >> replaceText 6
var 0E9FD854-1E0D-4184-9B4F-3F921CE64E78 = """ffmpeg -v warning -i "ï¿¼.ï¿¼" -c copy -map 0 -metadata creation_time=ï¿¼ -y a.mp4
mv -f a.mp4 "ï¿¼.ï¿¼"
"""
text("${0E9FD854-1E0D-4184-9B4F-3F921CE64E78}")
							} >> IFResult 48
							text(text: "${Repeat Item 2.as(File).get(File Extension)}touch ${Variable.as(File).get(File Extension)} "${If Result}.${ActionOutput}"") >> text 5
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.GetFileIntent
							setName(input: File, name: "${Repeat Item 2.as(File).get(Name)}")
						} >> RepeatResult 8
var media = Repeat Results
//Unable to get shortcuts action AsheKube.app.a-Shell-mini.ExecuteCommandIntent
					} >> IFResult 49
				}
			} >> IFResult 50
			if(media != nil) { >> IFResult 51
				keysFrom(dictionary: pref) >> Share
				if(Share == 1) {
					share(file: media) >> share
				} >> IFResult 52
				keysFrom(dictionary: pref) >> Save to Files
				if(Save to Files == 1) { >> IFResult 53
					keysFrom(dictionary: pref) >> keysFrom
					if(OS > 0) {
						if(Dictionary Value == nil) {
							menu(, [) {
							case("mainDict (onmy)Device Details (Device Type)"):
								number(value: 1)
							case("iCloud Drive"):
								number(value: 2)
							case("iCloud Drive/Shortcuts"):
								number(value: 3)
							} >> MenuResult 2
							setValue(key: "folderlocation", value: "${Menu Result.as(Number)}", dictionary: pref) >> setValue 9
var pref = Dictionary
//Unable to get shortcuts action is.workflow.actions.getvariable
						} >> IFResult 54
					} >> IFResult 55
					if(If Result == 1) {
//Unable to get shortcuts action is.workflow.actions.folder
					} else {
						if(If Result == 2) {
//Unable to get shortcuts action is.workflow.actions.folder
						} else {
//Unable to get shortcuts action is.workflow.actions.folder
						}
					} >> IFResult 56
					if(pref == nil) {
						if(OS > 0) {
							keysFrom(dictionary: mainDict)
						} else {
							keysFrom(dictionary: mainDict) >> keysFrom 1
						} >> IFResult 57
						askForInput(prompt: "${If Result}") >> askForInput
						text(text: "${Provided Input}") >> text 6
						setValue(key: "savefolder", value: "${Text}", dictionary: pref) >> setValue 10
var pref = Dictionary
						saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 7
						if(Provided Input != nil) {
							createFolder(path: "${pref.key(savefolder)}") >> createFolder
						}
					} >> IFResult 58
					saveFile(input: media, ask: false, path: "${pref.key(savefolder)}") >> saveFile 8
				} >> IFResult 59
				keysFrom(dictionary: pref) >> Save to Album
				if(Save to Album == 1) { >> IFResult 60
					keysFrom(dictionary: pref) >> album
					if(album == nil) {
						alert(alert: "${mainDict.key(msg.album)}", cancel: false)
						saveToCameraRoll(image: media, album: Ask) >> saveToCameraRoll
						getItemFromList(list: Saved Photo Media) >> getItemFromList 4
						text(text: "${Item from List}") >> text 7
						setValue(key: "album", value: "${Text}", dictionary: pref) >> setValue 11
var pref = Dictionary
						saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 9
					} else {
						if(album == "") {
							saveToCameraRoll(image: media) >> saveToCameraRoll 1
						} else {
							if(OS > 0) {
								createAlbum(photos: media, name: "${album}") >> createAlbum
							} else {
								saveToCameraRoll(image: media, album: album) >> saveToCameraRoll 2
							}
						}
					} >> IFResult 61
					keysFrom(dictionary: pref) >> â¤·Open Photos after Save
				} >> IFResult 62
				if(tweetDict != nil) {
					menu(, [) {
					case("mainDict (getsub)"):
						repeatEach(tweetDict) {
							getItemFromList(list: media, type: Item At Index, index: Repeat Index 2) >> getItemFromList 5
							getName() >> getName
							setName(input: Repeat Item 2, name: "${Name}.srt")
						} >> RepeatResult 9
						share(file: Repeat Results) >> share 1
					case("mainDict (skip)"):
					}
				}
				keysFrom(dictionary: pref) >> â¤·Show Notification
			}
/*
â—¢â—£		DOWNLOAD


*/
		} >> IFResult 63
		if(command != ""${mainDict.key(quit)}"") { >> IFResult 64
			if(command == ""${mainDict.key(settings)}"") { >> IFResult 65
/*


â—¥â—¤		SETTINGS
*/
var menu = Variable
				count(input: pref) >> count 2
				repeat(30) {
					if(menu ==) {
						keysFrom(dictionary: pref) >> keysFrom 2
						if(Dictionary Value != nil) {
							keysFrom(dictionary: pref) >> keysFrom 3
							if(Dictionary Value == 1) {
								text(text: "${mainDict.key(onmy)}${Variable.key(onmy)}") >> text 8
							} else {
								if(Dictionary Value == 2) {
									text(text: "iCloud")
								} else {
									text(text: "iCloud Drive/Shortcuts")
								}
							} >> IFResult 66
var 7BEE5DA5-7B51-48A4-879A-308C3C2B57E9 = """
ï¿¼â€˜ï¿¼/ï¿¼â€™"""
text("${7BEE5DA5-7B51-48A4-879A-308C3C2B57E9}")
						} >> folderpath
						keysFrom(dictionary: pref) >> keysFrom 4
						if(Dictionary Value != nil) {
							if(Dictionary Value == "") {
								keysFrom(dictionary: mainDict)
							} >> IFResult 67
var 8C15E988-3C8C-4D03-962E-54DFE822A673 = """
ï¿¼â€˜ï¿¼â€™"""
text("${8C15E988-3C8C-4D03-962E-54DFE822A673}")
						} >> albumname
						repeatEach(mainDict) {
							keysFrom(dictionary: pref) >> keysFrom 5
							if(Repeat Item 3 != nil) {
								keysFrom(dictionary: Repeat Item 3) >> keysFrom 6
								text(text: "${Repeat Item 3.as(Dictionary).key(title)}ã€€âž¤ã€€${Variable.as(Dictionary).key(title)}") >> text 9
							} else {
								keysFrom(dictionary: mainDict) >> keysFrom 7
								text(text: "${Dictionary Value}  ${ActionOutput}")
							} >> IFResult 68
						} >> RepeatResult 10
						list(items: (
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        OutputName = "Repeat Results";
                        OutputUUID = "1C0DD17D-B54B-4639-A988-823743B42ED7";
                        Type = ActionOutput;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = goback;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    }
)) >> list 1
						choose(list: List, prompt: "${mainDict.key(msg.settingprompt)}${Variable.key(msg.settingprompt)}${folderpath}") >> choose 4
						if(Chosen Item == ""${mainDict.key(goback)}"") {
							if(input != nil) {
var command = Variable
							} >> IFResult 69
var menu = Variable
						} else {
							repeat(Count) {
								keysFrom(dictionary: mainDict) >> keysFrom 8
								if(Chosen Item .contains ""${Dictionary Value}"") {
									number(value: Repeat Index 3) >> number 4
								} >> IFResult 70
							} >> RepeatResult 11
							keysFrom(dictionary: pref) >> keysFrom 9
							text(text: "${Dictionary Value}${ActionOutput}") >> text 10
							if(Text .between 17...18) {
								if(Text == 17) {
									setValue(key: "folderlocation", value: " ", dictionary: pref) >> setValue 12
									setValue(key: "savefolder", value: " ", dictionary: Dictionary) >> setValue 13
									replaceText(input: "${Dictionary}", find: ""(?:folderlocation|savefolder)":" ",?", isRegex: true)
								} else {
									setValue(key: "album", value: " ", dictionary: pref) >> setValue 14
									replaceText(input: "${Dictionary}", find: ""album":" ",?", isRegex: true)
								} >> IFResult 71
								getDictionaryFrom(input: If Result) >> getDictionaryFrom 4
var pref = Dictionary
							} >> IFResult 72
							keysFrom(dictionary: mainDict) >> keysFrom 10
							if(Dictionary Value == nil) {
								keysFrom(dictionary: mainDict)
							} >> OptionString
							count(input: OptionString) >> count 3
							keysFrom(dictionary: pref) >> keysFrom 11
							math(input: Dictionary Value, operation: â€¦, scientific: Modulus) >> math 9
							math(input: Calculation Result, operand: "1") >> NewOption
							repeatEach(pref) {
								if(Repeat Index 3 == Number) {
//Unable to get shortcuts action is.workflow.actions.getvariable
								}
							} >> RepeatResult 12
							setValue(key: "selection", value: "${Repeat Results.as(Number)}", dictionary: pref) >> setValue 15
var pref = Dictionary
							saveFile(input: pref, ask: false, path: "${mainDict.key(filename)}", overwrite: true) >> saveFile 10
						} >> IFResult 73
					} >> IFResult 74
				} >> RepeatResult 13
/*
â—¢â—£		SETTINGS


*/
			} >> IFResult 75
			if(command != ""${mainDict.key(download)}"") {
/*


â—¥â—¤		MENU
*/
//Unable to get shortcuts action dk.simonbs.Scriptable.RunScriptInlineIntent
				if(Output != nil) {
					wait(seconds: Output)
					runShortcut(name: "HiRes Twitter")
					exit()
				}
				if(Output != nil) {
var 6A8B97A7-8533-4D71-8F28-7C6B319C9D27 = """ï¿¼
ï¿¼
"""
text("${6A8B97A7-8533-4D71-8F28-7C6B319C9D27}")
				} else {
					keysFrom(dictionary: mainDict)
				} >> IFResult 76
				list(items: (
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = contact;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = account;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = settings;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = getlink;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    },
        {
        WFItemType = 0;
        WFValue =         {
            Value =             {
                attachmentsByRange =                 {
                    "{0, 1}" =                     {
                        Aggrandizements =                         (
                                                        {
                                DictionaryKey = quit;
                                Type = WFDictionaryValueVariableAggrandizement;
                            }
                        );
                        Type = Variable;
                        VariableName = mainDict;
                    };
                };
                string = "\Ufffc";
            };
            WFSerializationType = WFTextTokenString;
        };
    }
)) >> list 2
				choose(list: List, prompt: "${If Result}") >> choose 5
var command = Chosen Item
			} >> IFResult 77
			if(command == ""${mainDict.key(account)}"") { >> IFResult 78
/*


â—¥â—¤		ACCOUNT
*/
				alert(alert: "${mainDict.key(msg.accountprompt)}")
//Unable to get shortcuts action dk.simonbs.Scriptable.RunScriptInlineIntent
				exit()
			} >> IFResult 79
			if(command == ""${mainDict.key(getlink)}"") { >> IFResult 80
/*


â—¥â—¤		GET CLIPBOARD
*/
				getClipboard() >> getClipboard
				matchText(text: "${Clipboard}", regex: "twitter\.com/|t\.co/") >> matchText 1
				if(Matches != nil) {
					runShortcut(name: "HiRes Twitter", input: Clipboard) >> runShortcut
					exit()
				} else {
					alert(alert: "${Clipboard}", title: "${mainDict.key(msg.noclipboard)}", cancel: false)
				}
			}
			if(command == ""${mainDict.key(contact)}"") { >> IFResult 81
/*


â—¥â—¤		CONTACT
*/
				openURL(url: mainDict)
				exit()
			} >> IFResult 82
/*
â—¢â—£		NOT QUIT


*/
		} >> IFResult 83
		if(Update Menu Shown == nil) { >> IFResult 84
/*


â—¥â—¤		UPDATE
*/
			if(version .contains ""${mainDict.as(Dictionary).key(version)}"") {
				menu(, [) {
				case("mainDict (gotoweb)"):
					openURL(url: mainDict)
					exit()
				case("mainDict (downloadupdate)"):
					downloadURL(url: "${mainDict.key(downloadurl)}") >> downloadURL 1
					matchText(text: "${Contents of URL}", regex: "(?<="id":\D?)\d+") >> matchText 2
					expandURL(url: "https://routinehub.co/download/${Matches}/") >> expandURL 1
					replaceText(input: "${Expanded URL}", find: "^.+icloud.com/", replace: "shortcuts://", isRegex: true) >> replaceText 7
					openURL(url: Updated Text)
					exit()
				case("mainDict (notnow)"):
					number(value: 1) >> Update Menu Shown
				} >> MenuResult 3
			}
		}
/*
â—¢â—£		NOT QUIT


*/
	} >> IFResult 85
} >> RepeatResult 14
if(â¤·Open Photos after Save == 1) {
	openApp(id: "com.apple.mobileslideshow")
} >> IFResult 86
if(â¤·Show Notification == 1) {
	sendNotification(body: "${Media Info}", sound: false) >> sendNotification
} >> IFResult 87
